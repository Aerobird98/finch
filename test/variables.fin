Test.suite("Variables") is {
  Test.test("Define") is {
    var a = "something"
    Test.that(a) equals("something")
  }

  Test.test("Redefinition") is {
    var a = "before"
    Test.that(a) equals("before")
    // TODO(bob): This should be an error.
    var a = "after"
    Test.that(a) equals("after")
  }

  Test.test("Assignment") is {
    var a = "before"
    Test.that(a) equals("before")
    a = "after"
    Test.that(a) equals("after")
  }

  Test.test("Nested Local Scope") is {
    var a = "local"

    do { Test.that(a) equals("local") }

    Test.that(a) equals("local")
  }

  Test.test("Shadowed Local Scope") is {
    var a = "outer"

    do {
      var a = "inner"
      Test.that(a) equals("inner")
    }

    Test.that(a) equals("outer")
  }

  Test.test("Unshadow") is {
    var a = "first"

    do {
      Test.that(a) equals("first")
      var a = "shadow"
      Test.that(a) equals("shadow")
      var a = undefined
      Test.that(a) equals("first")
    }
  }

  Test.test("Assign to outer scope") is {
    var a = "outer"
    do { a = "inner" }
    Test.that(a) equals("inner")
  }

  Test.test("Field") is {
    obj foo {
      create { _field = "field" }
      test { Test.that(_field) equals("field") }
    }

    Test.that(_field) equals(nil)
    foo.create
    Test.that(_field) equals(nil)
    foo.test
  }
}
